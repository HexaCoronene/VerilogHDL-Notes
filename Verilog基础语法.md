# Verilog基础语法

Verilog 的出身来源于C语言

语法几乎和C语言完全一样，设计方法完全不一样

## 语言要素

### 空白符

空白符包括空格符（\b），制表符（\t），换行符和换页符。在编译和综合时，空白符被忽略。

空白符为了程序的易读性

### 注释符

同C语言

注释请使用英文，EDA对中文的兼容性非常不好

### 标识符

允许字母、数字、$ 符号和 ' _ ' 符号

### 转义标识符

没屁用

### 关键字

常用的写着写着就记住了

### 数值

- Verilog有四值电平逻辑
  - 0：低电平，逻辑0或假
  - 1：高电平，逻辑1或真
  - x 或 X：不确定或未知的逻辑状态
  - z 或 Z：高阻态

- 整数及其表示
  - +/- \<size>'\<base_format>\<number>
  - 二进制：b或B
  - 八进制：o或O
  - 十进制：d或D
  - 十六进制：h或H
  - 下划线符号“_"除了不能置于数值首位外，可以随意使用，对数值大小没有改变，只是为了提高可读性
  - 负数以补码来表示
  - 数字没有说明位宽，默认为32位
  - x和z在二进制中表示1位，八进制中表示3位，十六进制中表示4位
  - 若没有定义一个整数的位宽，其宽度为相应值中对应的宽度 `'o642 //9bit`

- 实数及其表示
  - 十进制表示法，采用十进制格式，小数点两边必须有数字，否则非法 eg. 3.0
  - 科学计数法，e或E

## 数据类型

### 物理数据类型

- 连线型
  - `wire`，`tri`
  - `wor`，`trior`
  - `wand`，`triand`
  - `trireg`
  - `tri1`
  - `tri0`
  - `supply1`
  - `supply0`
- 寄存器型
  - reg型是数据存储单元的抽象类型
  - reg型变量常用于行为级描述，由过程赋值语句对其进行赋值
- 存储器
  - 存储器型变量可以描述RAM类型，ROM类型以及reg文件

### 信号强度

- 表示数字电路中不同强度的驱动源，用来解决不同驱动强度存在下的赋值冲突

### 数据类型的声明

#### 连线型

`<net_declaration><drive_strength><range><delay>[list_of_variables]`

- net_declaration
- drive_strength：表示连线变量的驱动强度
- range：用来指定数据为标量或矢量。若该项默认，表示数据类型为1位标量，超过1位则为矢量
- delay：指定仿真延迟时间
- list_of_variables：变量名称，一次可定义多个，之间用逗号分隔

#### reg型

`reg<range>[list_of_variables]`

- range：
- list_of_variables：

#### 存储器型

`reg<range1><name_of_register><range2>`

- range1：表示存储器中寄存器的位宽，格式[msb:lsb]
- range2：表示寄存器的个数，格式[msb:lsb]，即有msb-lsb+1个
- name_of_register：变量名列表

### 抽象数据类型

#### 整型

整型数据常用于对循环控制变量的说明，在算术运算符中被视为二进制补码形式的有符号数。除了寄存器型数据被当做无符号数来处理之外，整型数据与32位寄存器型数据在实际意义上相同。

`integer <list_of_variables>`

#### 时间型

64位的无符号数。时间型数据主要用于对模拟时间的存储和计算处理，常与系统函数$time一起使用

`time <list_of_register_variables>`

#### 实型

实型数据在机器码中是浮点型数值，可用于对延迟时间的计算

`real  <list_of_variables>`

#### 参数型

参数在仿真开始之前被赋值，仿真过程中保持不变

采用参数定义方法可以提高程序的可读性和维护性

参数常用来定义延迟时间和变量的位宽

parameter 参数名 = 表达式

类比一下宏定义？

## 运算符

在硬件描述语言中，运算符代表了电路

- !、~
- *、/、%
- +、-
- <<、>>
- <、<=、>、>=
- \=\=、!=、=\=\=、!==
- &
- \^、^~
- |
- &&
- ||
- ?:

### 算术操作符

- 算术操作符的位宽
  - 算术操作符的位宽由最长操作数决定。在赋值语句下，算术操作符结果的长度由操作左端目标长度决定
- 有符号数和无符号数的使用
- 乘法器、除法和取模的适配

### 关系操作符

- 大于、大于等于、小于、小于等于
- 等于、不等于、全等、非全等
- 比较的结果有三种：真1，假0，不定值x

### 逻辑运算符

- 逻辑与、逻辑或、逻辑非

### 按位运算符

- 按位取反 ~ 、按位与 & 、按位或 | 、按位异或 ^ 、按位同或 ^~

### 归约运算符（缩位运算符）

- 与 & 、或 | 、异或 ^ 

```verilog
module test;
    reg [5:0] a;
    initial
        begin
            a = 6'b101011;
            $display("%b", &a);  //1'b0
            $display("%b", |a);  //1'b1
            $display("%b", ^a);  //1'b0
        end
endmodule
```

### 移位操作符

- 左移位操作符、右移位操作符
- 将左边（右边）的操作数向左（右）移，所移动的位数由右（左）边的操作数来决定，然后用0来填补移出的空位

### 条件运算符

- \<条件表达式>?\<表达式1>:\<表达式2>
- 条件表达式的结果有真1、假0和未知态x三种，当条件表达式的结果为真时，执行表达式1，当条件表达式结果为假时，执行表达式2
- 若表达式结果为不定态，模拟器将按位对表达式1的值和表达式2的值进行比较，（此处应有真值表），按表产生结果位，从而构成条件表达式的结果值

### 连接运算符和复制运算符

- 连接运算符\{  }：信号1的某几位，信号2的某几位……
- 重复运算符\{ \{  } }：将一个表达式放入双重花括号中，复制因子放在第一层括号中

## 模块

- 模块是Verilog HDL语言的基本单元，它代表一个基本的功能块，用于描述某个设计是功能或结构以及与其它模块通信的外部端口
- 一个模块主要包括：模块的开始与结束、模块端口定义、模块结构数据类型说明和模块逻辑功能描述

### 端口

- 端口的定义可以是输入端口、输出端口或双向端口
- 模块引用时端口的对应方式
  - 严格按照模块定义的端口顺序来连接：模块名 实例名（连接端口1信号名，连接端口2信号名，……）
  - 标明源模块定义时规定的端口名：模块名 实例名 （.端口1名（连接信号1名，.端口2名（连接信号2名），……）
  - 可以用端口名与被引用模块的端口对应，不必严格按端口顺序对应，提高程序的可读性

